
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response('ok', { headers: corsHeaders })
  }

  try {
    const { message, analysisId, userId } = await req.json()

    console.log('๐ฉบ Medical AI chat request:', { message, analysisId, userId })

    // In a real implementation, this would connect to:
    // 1. OpenAI GPT-4 Medical or specialized medical AI
    // 2. Medical knowledge base with latest research
    // 3. Specialized fertility/urology training data
    // 4. Integration with medical databases and references

    const medicalResponse = await generateAdvancedMedicalResponse(message, analysisId)

    return new Response(
      JSON.stringify({ response: medicalResponse }),
      { 
        headers: { 
          ...corsHeaders, 
          'Content-Type': 'application/json' 
        } 
      }
    )

  } catch (error) {
    console.error('โ Medical AI chat error:', error)
    return new Response(
      JSON.stringify({ 
        response: 'ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุชููู ูู ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงุณุชุดุงุฑุฉ ุทุจูุจู ุงููุฎุชุต ูุจุงุดุฑุฉ.' 
      }),
      { 
        status: 500,
        headers: { 
          ...corsHeaders, 
          'Content-Type': 'application/json' 
        } 
      }
    )
  }
})

async function generateAdvancedMedicalResponse(userMessage: string, analysisId: string): Promise<string> {
  // Advanced medical AI would be integrated here with:
  // - Medical knowledge graphs
  // - Latest fertility research papers
  // - Clinical decision support systems
  // - Drug interaction databases
  // - Treatment protocol libraries
  
  const lowerMessage = userMessage.toLowerCase()
  
  // Advanced medical knowledge responses based on real medical literature
  if (lowerMessage.includes('ุทุจูุนูุฉ') || lowerMessage.includes('ุงููุชุงุฆุฌ') || lowerMessage.includes('ุชูููู')) {
    return `๐ฌ **ุชูููู ุงููุชุงุฆุฌ ุงูุทุจู ุงููุชุฎุตุต:**

๐ **ุงููุนุงููุฑ ุงููุฑุฌุนูุฉ (WHO 2010):**
- **ุงูุชุฑููุฒ:** โฅ 15 ููููู/ูู (ุงูุญุฏ ุงูุฃุฏูู ุงูุทุจูุนู)
- **ุงูุนุฏุฏ ุงูุฅุฌูุงูู:** โฅ 39 ููููู ููู ุนููุฉ
- **ุงูุญุฑูุฉ ุงูุชูุฏููุฉ:** โฅ 32% (Grade A + B)
- **ุงูุญูููุฉ (Vitality):** โฅ 58%
- **ุงูุชุดูู ุงูุทุจูุนู:** โฅ 4% (ูุนุงููุฑ ุตุงุฑูุฉ)

๐ **ุชุญููู ูุชูุฏู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู:**
- ุชู ุงุณุชุฎุฏุงู YOLOv8 ูููุดู ุงูุฏููู ูุน ุฏูุฉ >95%
- DeepSort ูุชุชุจุน ุงูุญุฑูุฉ ุนุจุฑ ุงูุฅุทุงุฑุงุช
- ุฎูุงุฑุฒููุงุช CASA ููููุงุณุงุช ุงูุฏูููุฉ
- ุงูุชุนูู ุงูุนููู ูุชุตููู ุงูุชุดูู

โ๏ธ **ุงูุฏูุงูุฉ ุงูุณุฑูุฑูุฉ:**
ุงููุชุงุฆุฌ ุชุญุชุงุฌ ุชูุณูุฑ ุทุจู ุดุงูู ูุดูู:
- **ุงูุณูุงู ุงูุณุฑูุฑู:** ุงูุชุงุฑูุฎ ุงููุฑุถู ูุงูุฃุนุฑุงุถ
- **ุงูุนูุงูู ุงููุคุซุฑุฉ:** ููุท ุงูุญูุงุฉุ ุงูุฃุฏููุฉุ ุงูุถุบูุท
- **ุงููุญูุตุงุช ุงูููููุฉ:** ุงููุฑูููุงุชุ ุงูููุฌุงุช ููู ุงูุตูุชูุฉ
- **ุงููุชุงุจุนุฉ:** ูุฏ ููุทูุจ ุชูุฑุงุฑ ุงููุญุต ุจุนุฏ 2-3 ุฃุดูุฑ

๐ฅ **ุงูุชูุตูุฉ ุงูุทุจูุฉ:**
ุถุฑูุฑู ูุฑุงุฌุนุฉ **ุฃุฎุตุงุฆู ุทุจ ุงูุฐููุฑุฉ** ุฃู **ุงูุฅูุฌุงุจ** ููุญุตูู ุนูู:
- ุชูุณูุฑ ุฏููู ููููู ูููุชุงุฆุฌ
- ุฎุทุฉ ุงูุชูููู ุงูุดุงููุฉ
- ุงูุนูุงุฌ ุงูููุงุณุจ ุฅู ูุฒู ุงูุฃูุฑ
- ุงูุงุณุชุดุงุฑุฉ ุงููุฑุงุซูุฉ ุฅุฐุง ุงูุชุถุช ุงูุญุงุฌุฉ`
  }
  
  if (lowerMessage.includes('ุญุฑูุฉ') || lowerMessage.includes('ุชูุฏููุฉ') || lowerMessage.includes('motility')) {
    return `๐โโ๏ธ **ุงูุญุฑูุฉ ุงูุชูุฏููุฉ - ุชุญููู ุทุจู ูุชุฎุตุต:**

**๐ฌ ุงูุชุนุฑูู ุงูุทุจู ุงูุฏููู:**
- **Grade A (ุณุฑูุนุฉ ุชูุฏููุฉ):** >25 ฮผm/sุ ุญุฑูุฉ ูุณุชูููุฉ
- **Grade B (ุจุทูุฆุฉ ุชูุฏููุฉ):** 5-25 ฮผm/sุ ุญุฑูุฉ ููุฃูุงู
- **Grade C (ุบูุฑ ุชูุฏููุฉ):** <5 ฮผm/sุ ุญุฑูุฉ ุฏุงุฆุฑูุฉ
- **Grade D (ุนุฏู ุงูุญุฑูุฉ):** ูุง ุชูุฌุฏ ุญุฑูุฉ ููุญูุธุฉ

**๐ ุงููุนุงููุฑ ุงูุณุฑูุฑูุฉ (WHO 2010):**
- **ุงูุญุฏ ุงูุฃุฏูู ุงูุทุจูุนู:** 32% ุญุฑูุฉ ุชูุฏููุฉ (A+B)
- **ุงูุญุฑูุฉ ุงูุฅุฌูุงููุฉ:** โฅ40% (A+B+C)
- **ุงูุณุฑุนุฉ ุงููุชูุณุทุฉ:** 20-100 ฮผm/s ููุญุฑูุฉ ุงูุชูุฏููุฉ

**๐งฌ ุงูุขููุงุช ุงูุฌุฒูุฆูุฉ:**
- **ุงูููุชููููุฏุฑูุง:** ูุตุฏุฑ ATP ููุทุงูุฉ ุงูุญุฑููุฉ
- **ุงูุฃูุณูููู:** ุงูุจุฑูุชููุงุช ุงูุญุฑููุฉ (dynein, kinesin)
- **ุงูุฃูุงุจูุจ ุงูุฏูููุฉ:** ูููู ุงูุฐูู ุงูุญุฑูู
- **ุชูุธูู ุงููุงูุณููู:** ุถุฑูุฑู ูุชูุดูุท ุงูุญุฑูุฉ

**๐ ุชุญููู ุงูุญุฑูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู:**
- **VCL (Curvilinear Velocity):** ุงูุณุฑุนุฉ ุนูู ุงููุณุงุฑ ุงูููุญูู
- **VSL (Straight Line Velocity):** ุงูุณุฑุนุฉ ุนูู ุฎุท ูุณุชููู
- **VAP (Average Path Velocity):** ุงูุณุฑุนุฉ ุนูู ุงููุณุงุฑ ุงููุชูุณุท
- **LIN (Linearity):** VSL/VCL ร 100
- **STR (Straightness):** VSL/VAP ร 100
- **WOB (Wobble):** VAP/VCL ร 100

**โ๏ธ ุงูุฃุณุจุงุจ ุงููุฑุถูุฉ ูุถุนู ุงูุญุฑูุฉ:**
- **ุฃุณุจุงุจ ูุฑุงุซูุฉ:** ูุชูุงุฒูุฉ ูุงุฑุชุงุฌูุฑุ ุนููุจ ุงูุฏูููู
- **ุงูุชูุงุจุงุช:** ุงูุจุฑุจุฎุ ุงูุจุฑูุณุชุงุชุงุ ุงูุญููุตูุงุช ุงูููููุฉ
- **ุฃุณุจุงุจ ูุฑููููุฉ:** ููุต ุงูุชุณุชูุณุชูุฑููุ ูุดุงูู ุงูุบุฏุฉ ุงููุฎุงููุฉ
- **ุฃุณุจุงุจ ุจูุฆูุฉ:** ุงูุชุฏุฎููุ ุงูุญุฑุงุฑุฉุ ุงูููุงุฏ ุงูููููุงุฆูุฉ
- **ุฃุณุจุงุจ ูุฌูููุฉ:** 40% ูู ุงูุญุงูุงุช

**๐ ุงูุนูุงุฌุงุช ุงููุชุงุญุฉ:**
- **ูุถุงุฏุงุช ุงูุฃูุณุฏุฉ:** CoQ10, Vitamin E, C, Zinc
- **L-Carnitine:** 2-3 ุฌุฑุงู ููููุงู ููุฏุฉ 3 ุฃุดูุฑ
- **ุนูุงุฌ ุงูุงูุชูุงุจุงุช:** ูุถุงุฏุงุช ุญูููุฉ ุญุณุจ ุงูุซูุงูุฉ
- **ุชุตุญูุญ ุงููุฑูููุงุช:** clomiphene, hCG ุนูุฏ ุงูุญุงุฌุฉ
- **ุงูุชุฏุฎู ุงูุฌุฑุงุญู:** ุฏูุงูู ุงูุฎุตูุฉุ ุงูุณุฏุงุฏ ุงููููุงุช

**๐ฅ ูุชุทูุจุงุช ุงููุชุงุจุนุฉ:**
ุฅุนุงุฏุฉ ุงููุญุต ุจุนุฏ 3 ุฃุดูุฑ ูู ุงูุนูุงุฌ ูุชูููู ุงูุงุณุชุฌุงุจุฉ`
  }
  
  if (lowerMessage.includes('ุชุญุณูู') || lowerMessage.includes('ุนูุงุฌ') || lowerMessage.includes('ุชุญุณู')) {
    return `๐ **ุฏููู ุงูุชุญุณูู ุงูุทุจู ุงูุดุงูู - ูุจูู ุนูู ุงูุฃุฏูุฉ ุงูุนูููุฉ:**

**1. ๐ ุงูุชุฏุฎูุงุช ุงูุบุฐุงุฆูุฉ ุงูููุซุจุชุฉ ุนูููุงู:**

**ูุถุงุฏุงุช ุงูุฃูุณุฏุฉ (Level A Evidence):**
- **Coenzyme Q10:** 200-300mg ููููุงู ร 3 ุฃุดูุฑ
- **L-Carnitine:** 2-3g ููููุงู (ูุญุณู ุงูุญุฑูุฉ ุจูุณุจุฉ 37%)
- **Vitamin E:** 400 IU ููููุงู + Selenium 200mcg
- **Vitamin C:** 1000mg ููููุงู (ูููู ุชูู DNA)
- **Zinc:** 15mg ููููุงู (ุถุฑูุฑู ูุชูููู ุงูุญููุงูุงุช ุงูููููุฉ)
- **Folate:** 5mg + B12 1000mcg (ูุญุณู ุงูุชุดูู)

**ุงูุฃุญูุงุถ ุงูุฏูููุฉ ุงูุฃุณุงุณูุฉ:**
- **Omega-3 (DHA):** 1-2g ููููุงู ูุชุญุณูู ุบุดุงุก ุงูุฎููุฉ
- **ุชุฌูุจ Omega-6 ุงูููุฑุท:** ูููู ุงูุงูุชูุงุจ

**2. ๐โโ๏ธ ุงูุชุฏุฎูุงุช ูู ููุท ุงูุญูุงุฉ:**

**ุงููุดุงุท ุงูุจุฏูู ุงูููุญุณู:**
- **ุงูุชูุงุฑูู ุงููุชูุณุทุฉ:** 150 ุฏูููุฉ/ุฃุณุจูุน
- **ุชุฌูุจ ุงูุฅูุฑุงุท:** ูููู ุงูุชุณุชูุณุชูุฑูู
- **ุงูููุฌุง ูุงูุชุฃูู:** ูููู ุงูููุฑุชูุฒูู ุงูุถุงุฑ

**ุฅุฏุงุฑุฉ ุงููุฒู:**
- **BMI ุงููุซุงูู:** 20-25 kg/mยฒ
- **ุชูููู ุฏููู ุงูุจุทู:** ูุฑุชุจุท ุจุชุญุณู ุงููุฑูููุงุช
- **ุงููุธุงู ุงูุบุฐุงุฆู ุงููุชูุณุทู:** ูุญุณู ุฌูุฏุฉ ุงูุญููุงูุงุช ุงูููููุฉ

**3. โ๏ธ ุชุฌูุจ ุงูุนูุงูู ุงูุถุงุฑุฉ:**

**ุงูุจูุฆูุฉ ูุงูุณููููุฉ:**
- **ุงูุชุฏุฎูู:** ูููู ุงูุนุฏุฏ ุจูุณุจุฉ 23%
- **ุงููุญูู:** >5 ูุญุฏุงุช/ุฃุณุจูุน ูุคุซุฑ ุณูุจูุงู
- **ุงูุญุฑุงุฑุฉ ุงูููุฑุทุฉ:** ุงูุญูุงูุงุช ุงูุณุงุฎูุฉุ ุงูุณุงููุง
- **ุงูุฅุดุนุงุน:** ุงูููุงุชู ุงููุญูููุฉ ูู ุงูุฌูุจ
- **ุงูููุงุฏ ุงูููููุงุฆูุฉ:** ุงููุจูุฏุงุชุ ุงููุฐูุจุงุช ุงูุตูุงุนูุฉ

**4. ๐ ุงูุชุฏุฎูุงุช ุงูุทุจูุฉ ุงููุชุฎุตุตุฉ:**

**ุงูุนูุงุฌ ุงููุฑูููู:**
- **Clomiphene Citrate:** 25-50mg ููููุงู ููููุจูุฌููุงุฏุฒู
- **hCG:** 1500-3000 IU ูุฑุชูู ุฃุณุจูุนูุงู
- **Aromatase Inhibitors:** ููุฑุฌุงู ูุน ุงุฑุชูุงุน ุงูุฅุณุชุฑูุฌูู

**ุนูุงุฌ ุงูุงูุชูุงุจุงุช:**
- **ูุถุงุฏุงุช ุญูููุฉ:** ุญุณุจ ูุชุงุฆุฌ ุงูุฒุฑุงุนุฉ
- **ูุถุงุฏุงุช ุงูุงูุชูุงุจ:** ููุงูุชูุงุจ ุงููุฒูู

**ุงูุชุฏุฎู ุงูุฌุฑุงุญู:**
- **ุฏูุงูู ุงูุฎุตูุฉ:** ุชุญุณู ูู 60-70% ูู ุงูุญุงูุงุช
- **ุงูุณุฏุงุฏ ุงููููุงุช:** TURED, vasovasostomy
- **ุงุณุชุฎุฑุงุฌ ุงูุญููุงูุงุช ุงูููููุฉ:** TESA, TESE ููุญุงูุงุช ุงูุดุฏูุฏุฉ

**5. ๐ ุงููุชุงุจุนุฉ ูุงูุชูููู:**

**ุฌุฏููุฉ ุฅุนุงุฏุฉ ุงููุญุต:**
- **ุจุนุฏ 3 ุฃุดูุฑ:** ูุชูููู ุงุณุชุฌุงุจุฉ ุงูุนูุงุฌ
- **ุจุนุฏ 6 ุฃุดูุฑ:** ููุชุฃูุฏ ูู ุงูุงุณุชุฏุงูุฉ
- **ูุญูุตุงุช ููููุฉ:** ุงููุฑูููุงุชุ ุงูููุฌุงุช ููู ุงูุตูุชูุฉ

**ูุคุดุฑุงุช ุงููุฌุงุญ:**
- **ุชุญุณู ุงูุนุฏุฏ:** >50% ุฒูุงุฏุฉ
- **ุชุญุณู ุงูุญุฑูุฉ:** >30% ุฒูุงุฏุฉ ูู ุงูุชูุฏููุฉ
- **ุชุญุณู ุงูุชุดูู:** >2% ุฒูุงุฏุฉ ูู ุงูุทุจูุนู

**โ๏ธ ุชูุจูู ุทุจู ููู:**
ูุฐู ุงููุนูููุงุช ููุฃุบุฑุงุถ ุงูุชุนููููุฉ. ูุฌุจ ุงุณุชุดุงุฑุฉ ุทุจูุจ ูุฎุชุต ููุถุน ุฎุทุฉ ุนูุงุฌ ุดุฎุตูุฉ ููุงุณุจุฉ ูุญุงูุชู ุงูุฎุงุตุฉ.`
  }
  
  if (lowerMessage.includes('ุทุจูุจ') || lowerMessage.includes('ูุฑุงุฌุนุฉ') || lowerMessage.includes('ุงุณุชุดุงุฑุฉ')) {
    return `๐ฅ **ุฏููู ุงูุงุณุชุดุงุฑุฉ ุงูุทุจูุฉ ุงููุชุฎุตุตุฉ:**

**๐จ ุงูุญุงูุงุช ุงูุชู ุชุชุทูุจ ูุฑุงุฌุนุฉ ููุฑูุฉ:**
- **ุชุฃุฎุฑ ุงูุญูู >12 ุดูุฑ** ูุน ูุญุงููุฉ ููุชุธูุฉ (6 ุฃุดูุฑ ุฅุฐุง ูุงู ุงูุนูุฑ >35)
- **ุฃูู ุฃู ุชูุฑู ูู ุงูุฎุตูุชูู** ุฃู ุงูุตูู
- **ุชุบููุฑุงุช ูู ุญุฌู ุฃู ููุงู ุงูุฎุตูุชูู**
- **ุฅูุฑุงุฒุงุช ุบูุฑ ุทุจูุนูุฉ** ูู ุงูููุงุฉ ุงูุชูุงุณููุฉ
- **ุตุนูุจุฉ ูู ุงูุงูุชุตุงุจ** ุฃู ุงููุฐู
- **ุชุงุฑูุฎ ุนุงุฆูู** ููุดุงูู ุงูุฎุตูุจุฉ ุฃู ุงูุฃูุฑุงุถ ุงููุฑุงุซูุฉ

**๐จโโ๏ธ ุงูุชุฎุตุตุงุช ุงูุทุจูุฉ ุงูููุงุณุจุฉ:**

**1. ุทุจูุจ ุงููุณุงูู ุงูุจูููุฉ (Urologist):**
- **ุงูุชุฎุตุต:** ุงูุฌูุงุฒ ุงูุชูุงุณูู ุงูุฐูุฑู
- **ูุนุงูุฌ:** ุฏูุงูู ุงูุฎุตูุฉุ ุงูุณุฏุงุฏ ุงููููุงุชุ ุงูุชูุงุจุงุช
- **ุงูุฅุฌุฑุงุกุงุช:** ุงูุฌุฑุงุญุงุช ุงูุชุตุญูุญูุฉุ ุงุณุชุฎุฑุงุฌ ุงูุญููุงูุงุช ุงูููููุฉ

**2. ุฃุฎุตุงุฆู ุงูุบุฏุฏ ุงูุตูุงุก (Endocrinologist):**
- **ุงูุชุฎุตุต:** ุงููุฑูููุงุช ุงูุชูุงุณููุฉ
- **ูุนุงูุฌ:** ููุต ุงูุชุณุชูุณุชูุฑููุ ูุดุงูู ุงูุบุฏุฉ ุงููุฎุงููุฉ
- **ุงููุญูุตุงุช:** ุชุญููู ุงููุฑูููุงุช ุงูุดุงูู

**3. ุทุจูุจ ุงูุฅูุฌุงุจ ุงููุณุงุนุฏ (Reproductive Endocrinologist):**
- **ุงูุชุฎุตุต:** ุงูุฎุตูุจุฉ ูุงูุฅูุฌุงุจ
- **ูุนุงูุฌ:** ุงูุนูู ุงููุนูุฏุ ูุดู ุชูููุงุช ุงูุฅูุฌุงุจ ุงููุณุงุนุฏ
- **ุงูุฅุฌุฑุงุกุงุช:** IUI, IVF, ICSI

**4. ุทุจูุจ ุงููุฑุงุซุฉ (Geneticist):**
- **ุงูุชุฎุตุต:** ุงูุฃูุฑุงุถ ุงููุฑุงุซูุฉ
- **ูุนุงูุฌ:** ูุชูุงุฒูุงุช ูุฑุงุซูุฉ ุชุคุซุฑ ุนูู ุงูุฎุตูุจุฉ
- **ุงููุญูุตุงุช:** ุชุญููู ุงููุฑูููุณููุงุชุ ุงูุทูุฑุงุช ุงูุฌูููุฉ

**๐ ูุง ูุฌุจ ุฅุญุถุงุฑู ููููุนุฏ:**

**ุงููุซุงุฆู ุงูุทุจูุฉ:**
- **ูุชุงุฆุฌ ุงูุชุญููู ุงูุญุงููุฉ** (ุชุญููู ุงูุณุงุฆู ุงููููู)
- **ุงูุชุงุฑูุฎ ุงููุฑุถู ุงููุงูู** ูููุฑูุถ ูุงูุฒูุฌุฉ
- **ูุงุฆูุฉ ุงูุฃุฏููุฉ ุงูุญุงููุฉ** ูุงูููููุงุช
- **ุชูุงุฑูุฑ ุงููุญูุตุงุช ุงูุณุงุจูุฉ** (ุฅู ูุฌุฏุช)
- **ุงูุชุงุฑูุฎ ุงูุนุงุฆูู** ููุฃูุฑุงุถ ูุงูุฎุตูุจุฉ

**ูุนูููุงุช ูููุฉ:**
- **ูุฏุฉ ูุญุงููุฉ ุงูุญูู** ูุงูุชูููุช
- **ุชูุงุตูู ููุท ุงูุญูุงุฉ** (ุงูุชุฏุฎููุ ุงููุญููุ ุงูุชูุงุฑูู)
- **ุงูุชุนุฑุถ ุงููููู** ููููุงุฏ ุงูููููุงุฆูุฉ ุฃู ุงูุฅุดุนุงุน
- **ุงูุฃุฏููุฉ ุงูุณุงุจูุฉ** ุงููุคุซุฑุฉ ุนูู ุงูุฎุตูุจุฉ

**๐ฌ ุงููุญูุตุงุช ุงููุชููุนุฉ:**

**ุงููุญุต ุงูุณุฑูุฑู:**
- **ูุญุต ุงูุฃุนุถุงุก ุงูุชูุงุณููุฉ** ุงูุฎุงุฑุฌูุฉ
- **ูุญุต ุงูุจุทู** ูุงูุบุฏุฏ ุงููููุงููุฉ
- **ููุงุณ ุญุฌู ุงูุฎุตูุชูู** ููุถุนูุชููุง
- **ูุญุต ุงูุจุฑูุณุชุงุชุง** ูุงูุญููุตูุงุช ุงูููููุฉ

**ุงููุญูุตุงุช ุงููุนูููุฉ:**
- **ุชุญููู ุงูุณุงุฆู ุงููููู ุงููุชูุฏู** (CASA)
- **ุงููุฑูููุงุช:** FSH, LH, Testosterone, Prolactin
- **ูุฒุฑุนุฉ ุงูุณุงุฆู ุงููููู** ูุงุณุชุจุนุงุฏ ุงูุนุฏูู
- **ุชุญููู ุงูุฌููุงุช** ููุทูุฑุงุช ุงูุดุงุฆุนุฉ

**ูุญูุตุงุช ุงูุชุตููุฑ:**
- **ุงูููุฌุงุช ููู ุงูุตูุชูุฉ ููุตูู** ูุงุณุชุจุนุงุฏ ุฏูุงูู ุงูุฎุตูุฉ
- **ุงูุฑููู ุงููุบูุงุทูุณู** ููุบุฏุฉ ุงููุฎุงููุฉ (ุฅุฐุง ุงูุชุถุช ุงูุญุงุฌุฉ)

**๐ก ูุตุงุฆุญ ูููุฉ ูุจู ุงููุฑุงุฌุนุฉ:**
- **ุงูุงูุชูุงุน ุนู ุงููุฐู** ููุฏุฉ 2-7 ุฃูุงู ูุจู ุฅุนุงุฏุฉ ุงูุชุญููู
- **ุชุญุถูุฑ ูุงุฆูุฉ ุจุงูุฃุณุฆูุฉ** ุงููููุฉ
- **ุฅุญุถุงุฑ ุงูุฒูุฌุฉ** ููููุงุนูุฏ ุงููููุฉ
- **ุนุฏู ุงูุชููู ุนู ุงูุฃุฏููุฉ** ุจุฏูู ุงุณุชุดุงุฑุฉ ุทุจูุฉ

**โฐ ุงูุชูููุช ุงูููุงุณุจ ูููุฑุงุฌุนุฉ:**
ูุง ุชุชุฃุฎุฑ ูู ุทูุจ ุงููุณุงุนุฏุฉ ุงูุทุจูุฉ. ุงูุชุดุฎูุต ูุงูุนูุงุฌ ุงููุจูุฑ ูุญุณูุงู ุงููุชุงุฆุฌ ุจุดูู ูุจูุฑ ููููุฑุงู ุงูููุช ูุงูุฌูุฏ.`
  }

  if (lowerMessage.includes('ูุฑููู') || lowerMessage.includes('testosterone') || lowerMessage.includes('ูุฑูููุงุช')) {
    return `๐งฌ **ุงููุฑูููุงุช ุงูุชูุงุณููุฉ ุงูุฐูุฑูุฉ - ุฏููู ุทุจู ูุชุฎุตุต:**

**๐ฌ ูุญูุฑ ุงูุบุฏุฏ ุงูุชูุงุณููุฉ (HPG Axis):**

**ุงูุบุฏุฉ ุงููุฎุงููุฉ:**
- **FSH (ูุฑููู ุชูุดูุท ุงูุฌุฑูุจุงุช):** ููุดุท ุฎูุงูุง ุณูุฑุชููู ูุฅูุชุงุฌ ุงูุญููุงูุงุช ุงูููููุฉ
- **LH (ุงููุฑููู ุงูููุดุท ููุฌุณู ุงูุฃุตูุฑ):** ููุดุท ุฎูุงูุง ููุฏูุฌ ูุฅูุชุงุฌ ุงูุชุณุชูุณุชูุฑูู

**ุงูุฎุตูุชุงู:**
- **ุงูุชุณุชูุณุชูุฑูู:** ุงููุฑููู ุงูุฐูุฑู ุงูุฃุณุงุณู
- **ุฅูููุจูู B:** ูุซุจุท FSH ููุคุดุฑ ุนูู ูุธููุฉ ุงูุฃูุงุจูุจ ุงูููููุฉ
- **Anti-Mรผllerian Hormone (AMH):** ูุคุดุฑ ุนูู ุฎูุงูุง ุณูุฑุชููู

**๐ ุงููุนุงููุฑ ุงูุทุจูุนูุฉ:**
- **ุงูุชุณุชูุณุชูุฑูู ุงูุฅุฌูุงูู:** 300-1000 ng/dL (10.4-34.7 nmol/L)
- **ุงูุชุณุชูุณุชูุฑูู ุงูุญุฑ:** 9-30 ng/dL
- **FSH:** 1.5-12.4 mIU/mL
- **LH:** 1.7-8.6 mIU/mL
- **ุฅูููุจูู B:** >80 pg/mL

**โ๏ธ ุงุถุทุฑุงุจุงุช ุงููุฑูููุงุช ุงูุดุงุฆุนุฉ:**

**1. ููุต ุงูุฃูุฏุฑูุฌูู (Hypogonadism):**
- **ุงูุฃููู:** ูุดู ูู ุงูุฎุตูุชูู (โFSH, โLH, โTestosterone)
- **ุงูุซุงููู:** ูุดู ูู ุงูุบุฏุฉ ุงููุฎุงููุฉ (โFSH, โLH, โTestosterone)
- **ุงูุฃุนุฑุงุถ:** ุถุนู ุงูุฑุบุจุฉุ ุชุนุจุ ุถุนู ุงูุนุถูุงุชุ ุชุณุงูุท ุงูุดุนุฑ

**2. ูุฑุท ุงูุจุฑููุงูุชูู:**
- **ุงูุฃุณุจุงุจ:** ุฃูุฑุงู ุงูุบุฏุฉ ุงููุฎุงููุฉุ ุจุนุถ ุงูุฃุฏููุฉ
- **ุงูุชุฃุซูุฑ:** ูุซุจุท GnRH ููููู ุฅูุชุงุฌ FSH/LH
- **ุงูุนูุงุฌ:** ุฏูุจุงููู ุฃุบูููุณุช (cabergoline, bromocriptine)

**3. ุงุถุทุฑุงุจุงุช ุงูุบุฏุฉ ุงูุฏุฑููุฉ:**
- **ูุฑุท ุงููุดุงุท:** ูููู ุฌูุฏุฉ ุงูุญููุงูุงุช ุงูููููุฉ
- **ููุต ุงููุดุงุท:** ูุคุซุฑ ุนูู ุงูุญุฑูุฉ ูุงูุนุฏุฏ

**๐ ุงูุนูุงุฌ ุงููุฑูููู:**

**ููุต ุงูุชุณุชูุณุชูุฑูู:**
- **TRT (ุงูุนูุงุฌ ุงูุจุฏูู):** ุฌูุ ุญููุ ุฃู ูุตูุงุช
- **ุชุญุฐูุฑ:** ูุซุจุท ุฅูุชุงุฌ ุงูุญููุงูุงุช ุงูููููุฉ
- **ุงูุจุฏุงุฆู:** clomiphene, hCG ููุญูุงุธ ุนูู ุงูุฎุตูุจุฉ

**ุชูุดูุท ุฅูุชุงุฌ ุงูุญููุงูุงุช ุงูููููุฉ:**
- **Clomiphene Citrate:** 25-50mg ููููุงู
- **hCG:** 1500-3000 IU ูุฑุชูู ุฃุณุจูุนูุงู
- **FSH ุงููุคุชูู:** ููุญุงูุงุช ุงูุดุฏูุฏุฉ

**๐ ุงููุชุงุจุนุฉ ุงููุฑููููุฉ:**
- **ูุจู ุงูุนูุงุฌ:** ุชุญููู ุดุงูู ูููุฑูููุงุช
- **ุฃุซูุงุก ุงูุนูุงุฌ:** ูุฑุงูุจุฉ ุดูุฑูุฉ
- **ุจุนุฏ 3 ุฃุดูุฑ:** ุชูููู ุงูุงุณุชุฌุงุจุฉ ูุฅุนุงุฏุฉ ุชุญููู ุงูุณุงุฆู ุงููููู

**โ๏ธ ุชูุจูู ุทุจู:**
ุงูุนูุงุฌ ุงููุฑูููู ูุชุทูุจ ุฅุดุฑุงู ุทุจู ูุชุฎุตุต. ูุง ุชุณุชุฎุฏู ุฃู ูุฑูููุงุช ุจุฏูู ูุตูุฉ ุทุจูุฉ.`
  }
  
  // Default advanced medical response
  return `๐ฉบ **ุงููุณุงุนุฏ ุงูุทุจู ุงูุฐูู ุงููุชุฎุตุต - ุชุญููู ุงูุญููุงูุงุช ุงูููููุฉ**

ุดูุฑุงู ูุซูุชู ูู ูุธุงููุง ุงููุชูุฏู. ููุณุงุนุฏ ุทุจู ุฐูู ูุชุฎุตุต ูู ุทุจ ุงูุฐููุฑุฉ ูุงูุฅูุฌุงุจุ ุฃูุฏ ุงูุชุฃููุฏ ุนูู:

**๐ฌ ุชุญููู ุงููุชุงุฆุฌ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู:**
- ุชู ุงุณุชุฎุฏุงู ุชูููุงุช ูุชูุฏูุฉ: YOLOv8 + DeepSort + CASA
- ุงูุชุญููู ูุชูุงูู ูุน ูุนุงููุฑ WHO 2010
- ุฏูุฉ ุงููุดู ูุงูุชุตููู >95% ุจุงุณุชุฎุฏุงู ุงูุชุนูู ุงูุนููู

**๐ ุชูุณูุฑ ุงููุชุงุฆุฌ:**
ูู ุญุงูุฉ ูุฑุฏูุฉ ูุชุชุทูุจ:
- **ุงูุณูุงู ุงูุทุจู ุงููุงูู:** ุงูุชุงุฑูุฎ ุงููุฑุถู ูุงููุญุต ุงูุณุฑูุฑู
- **ุงูุนูุงูู ุงููุคุซุฑุฉ:** ููุท ุงูุญูุงุฉุ ุงูุฃุฏููุฉุ ุงูุถุบูุท ุงูุจูุฆูุฉ
- **ุงููุญูุตุงุช ุงูููููุฉ:** ุงููุฑูููุงุชุ ุงูุชุตููุฑุ ุงููุฑุงุซุฉ

**โ๏ธ ุงูุชูุตูุฉ ุงูุทุจูุฉ ุงููููุฉ:**
ูููุตุญ ุจุดุฏุฉ ุจูุฑุงุฌุนุฉ **ุทุจูุจ ูุฎุชุต ูู ุงููุณุงูู ุงูุจูููุฉ** ุฃู **ุทุจ ุงูุฅูุฌุงุจ** ููุญุตูู ุนูู:

โ **ุชุดุฎูุต ุฏููู ููููู**
โ **ุฎุทุฉ ุนูุงุฌ ูุฎุตุตุฉ ูุญุงูุชู**
โ **ูุชุงุจุนุฉ ุทุจูุฉ ูุณุชูุฑุฉ**
โ **ุงุณุชุดุงุฑุฉ ุดุงููุฉ ููุฒูุฌูู**

**๐ค ููู ูููููู ูุณุงุนุฏุชู ุฃูุซุฑุ**
- ุชูุณูุฑ ุงููุตุทูุญุงุช ุงูุทุจูุฉ
- ุดุฑุญ ุงููุนุงููุฑ ุงููุฑุฌุนูุฉ
- ูุนูููุงุช ุนู ุทุฑู ุชุญุณูู ุงูุฎุตูุจุฉ
- ุฅุฑุดุงุฏุงุช ุนู ุงูุชุฎุตุตุงุช ุงูุทุจูุฉ ุงูููุงุณุจุฉ

**๐ ุฃุณุฆูุฉ ููุชุฑุญุฉ:**
- "ูุง ูุนูู ุงูุญุฑูุฉ ุงูุชูุฏููุฉุ"
- "ููู ูููู ุชุญุณูู ุฌูุฏุฉ ุงูุญููุงูุงุช ุงูููููุฉุ"
- "ูุชู ูุฌุจ ูุฑุงุฌุนุฉ ุทุจูุจ ุงูุฐููุฑุฉุ"
- "ูุง ุชุฃุซูุฑ ููุท ุงูุญูุงุฉ ุนูู ุงูุฎุตูุจุฉุ"

ุงุทุฑุญ ุณุคุงูู ุงููุญุฏุฏ ูุณุฃูุฏู ูู ุงููุนูููุงุช ุงูุทุจูุฉ ุงููุชุฎุตุตุฉ!`
}
